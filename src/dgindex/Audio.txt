Dolby Digital Decode 

Dynamic Range Control and Dolby Surround affect the result of Decode.

Different listening environments present a wide variety of dynamic range requirements. Obviously a quiet movie does not fit well into a noisy environment, nor does a loud movie fit into a quiet environment. The classic solution has been to dramatically reduce the dynamic range of the audio prior to transmission, then the audio level can be set once by each viewer to suit his or her environment. The unfortunate side effect is that audio impact is lost. Explosions, dialogue, and background grasshoppers are all reproduced at the same loudness and the program can sound, well, flat - to say the least.

Happily, there is another solution. Dolby Digital provides a Dynamic Range Control (DRC) system that is rather unique. Based on a pre-selected DRC profile, the Dolby Digital encoders calculate and send DRC metadata along with the original audio signal. The DRC metadata can then be applied to the signal by the decoder to reduce the signal's dynamic range. On many decoders, DRC can optionally be scaled back or even disabled so that the original dynamic range of the audio is delivered.

This unique consumer-side dynamic range processing allows the kitchen DTV set to have restricted dynamic range so that quiet audio can be heard above background noise, while simultaneously the large DTV set in the family room can have unrestricted dynamic range and can stomp on the background noise (and possibly the neighbors). DRC helps to provide the best possible presentation of program content in virtually any listening environment, regardless of the quality of the equipment, number of channels, or ambient noise level.

The Dolby Digital stream carries metadata for the two possible operating modes of the decoder. The operating modes are known as Line Mode and RF Mode due to the type of output with which they are typically associated. Line Mode is relatively light dynamic range compression and is typically used on decoders with six- or two-channel line-level outputs. RF Mode is designed for products such as set-top boxes that have RF re-modulated (i.e. Channel 3 or 4) outputs. RF Mode is heavier dynamic range compression and the peaks are limited to prevent severe overmodulation of television receivers. Full-featured decoders allow the consumer to select whether to use DRC and if so, how much. Thankfully, the consumer sees simple options such as Off, Light Compression, and Heavy Compression instead of None, Line Mode, and RF Mode. 

Six preset DRC profiles are available in the Dolby Digital system: Film Light, Film Standard, Music Light, Music Standard, Speech, and None, and each can be chosen separately for Line and RF Modes. The station - or ideally the content producer - chooses which of these profiles to assign to each mode. When the consumer or decoder selects a DRC mode (i.e. apply DRC fully, not at all, or somewhere in-between), the chosen profile is applied to the decoded audio.

In addition, signal peaks can be limited to prevent clipping during downmixing through the use of overload protection metadata. For example, consider a 5.1-channel program with signals near digital full scale on all channels being played through a stereo set-top box. Without some form of attenuation or limiting, the output signal would obviously clip as the 5.1 channels are being downmixed to stereo. Proper setting of dialogue level and DRC parameters can prevent clipping, but just in case, protection DRC can kick in and maintain control, although it is best to avoid this. It is important to note that even if the "None" profile is chosen, protection DRC is still active.

The optimal option of Dynamic Range Control mainly depends on the nature of source and audio-visual environment. 
In my opinion, it's better to select Normal for movie titles and Off for music titles. 
Sometimes there is no difference since the manufacturer prefers full dynamic range and doesn't provide DRC. 

Normal is similiar to 'Line out mode' and Heavy is similiar to 'RF-remod mode' of Sonic Foundary Soft Encode. 
It seems the WinDVD directshow filter (iviaudio.ax) invokes Heavy DRC also. However, Heavy is NOT recommended 
because it usually results in obvious volume transitions, especially for music titles. 

DRC averages the volume (dynamic range compression) and Normalization is still necessary after DRC. 

Dolby Surround Downmix turns your 5.1 channel signal into a 2.0 channel that's dolby pro logic encoded.

The difference between Conventional Stereo and Dolby Surround Downmix 
Conventional Stereo (5.1->2ch)


Lo = L + c' * C + s' * Ls (+ lfe' * LFE) 
Ro = R + c' * C + s' * Rs (+ lfe' * LFE) 
Dolby Surround Downmix (5.1->2ch)


Ls + Rs -> 7KHz low-pass filter (in order to obey the DS spec) -> S 
Lt = L + c" * C - s" * S (+ lfe" * LFE) 
Rt = R + c" * C + s" * S (+ lfe" * LFE) 

Lt, Rt -> Pro-Logic rematrixing (inverse computation) -> L, R, C, S (2->4ch) 

Downmixing allows a multichannel program to be reproduced over fewer speaker channels than for which the program is optimally intended. Simply put, downmixing allows consumers to enjoy a 5.1 channel broadcast regardless of how many speakers they have.

Set-top boxes, used for the reception of terrestrial, cable, or satellite, typically offer an analog mono signal modulated on the Channel 3/4 output, a line-level analog stereo signal and an optical or coaxial digital output. The analog stereo output is a downmixed version of the decoded Dolby Digital bitstream while the digital output delivers the Dolby Digital bitstream to a downstream decoder.

In each of these devices, the analog stereo output is one of two different stereo downmixes. One type is a surround-compatible downmix (left-total/right-total, or Lt/Rt) of the multichannel source program suitable for Dolby Surround Pro Logic or other matrix decoding. The other type is a simple stereo downmix (called a left-only/right-only, or Lo/Ro) suitable for playback on a two-channel stereo system or on headphones, and from which a mono signal is derived for use by an RF re-modulator.

The only difference between the downmixes is how the surround channels are handled. The Lt/Rt downmix sums the surround channels, attenuates them 3 dB (i.e. multiply by 0.707) and adds them out-of-phase to the left channel and in-phase to the right channel. This allows a Pro Logic home theater decoder to produce L/C/R/S channels when connected to a stereo set-top box or DTV receiver. Conversely, the Lo/Ro downmix adds the right and left surround channels discretely to the left and right speaker channels. This preserves the stereo separation for stereo-only monitoring and produces a mono-compatible signal. Lt/Rt is the default selection in all consumer decoders with the exception that the mono signal feeding the RF re-modulator output is derived from a Lo/Ro downmix.

The formula for Lt/Rt compatible and Lo/Ro stereo downmixes are: 

Lt = L + (0.707*C) - (0.707*Ls) - (0.707*Rs) 

Rt = R + (0.707*C) + (0.707*Ls) + (0.707*Rs) 

Lo = L + (clev*C) + (slev*Ls) 

Ro = R + (clev*C) + (slev*Rs) 


With Lo/Ro you can see that there are separate metadata parameters included in the downmix formula. The metadata parameters clev (center level) and slev (surround level) default to 0.707 (i.e. -3dB just like in Lt/Rt) but can be adjusted to fine-tune the stereo downmix.

What about the LFE channel? Well, it is simply discarded. Be very careful about audio that is only in the LFE channel for the logical reason that not all consumers will hear it.

All of this stuff looks good on paper, but does it really work? Sometimes yes, sometimes not quite. Next time we will wrap up metadata with a discussion of some real world issues. Thanks to everyone for your continued support and suggestions; it's great to hear from old friends and new ones. I appreciate all of your comments and ideas and will continue to do my best to address them.


--------------------------------------------------------------------------------

48 -> 44.1KHz 

DVD2AVI implants the downsampling algorithm from WAVEFS44. 
The difference is that DVD2AVI preserves the gain=1 and invokes overflow clipping. 

Although this conversion takes a lot of time, the quality is excellent compared with other softwares. 
Mid provides the acceptable quality in many cases. 
UltraHigh is designed for those who pursue for the best. 

--------------------------------------------------------------------------------

Normalization 

Normalization modifies the volume to a certain degree. 
The optimal value depends on your applications. 
For example, I usually choose 100 for PC headphone (MPEG-4) and 70 for TV display (VCD) 

Audio normalization is the process of increasing (or decreasing) the amplitude (volume) of a digital audio recording. Typically normalization increases the amplitude of the audio waveform to the maximum level without introducing any distortion into the recording.

Common Normalization settings include 95% and 98% of full volume.

Often times, if the internal volume is too loud, normalization causes the waveform to clip. Hard Limiting can fix this by boosting the internal level but keeping the waveform below a certain set dB.

--------------------------------------------------------------------------------

Pre-Scale Decision is designed to reduce the quantization error of Dolby Digital decoding. 
Specify the Track Number and set the value of Normalization at first then start Pre-Scale Decision. 
It will take a while to decode and compute the pre-scale ratio by peak value. 
This ratio is shown by Info value of Information Window and applied to later decoding as long as it is left checked.
This brings the loudest level up to normalization setting of maximum, thereby avoiding clipping. 

